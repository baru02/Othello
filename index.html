<!DOCTYPE html>
<html>
	<head>
		<script type="text/javascript" src="raphael-min.js"></script>
		<script type="text/javascript">
		(function () {
		    "use strict";
		    var whites = "#9d9d9d";
		    var blacks = "#222";
		    var size = 8;
		    var cellsize = 64;
		    var baseOffset = 100;
		    var gridsize = size * cellsize + 2 * baseOffset;
		    var Field = function (xcord, ycord, row, column, r) {
		            var field = r.rect(xcord, ycord, cellsize, cellsize).attr({
		                fill: "#333333",
		                stroke: "#422faa"
		            });
		            var circlefield = r.circle(xcord + cellsize / 2, ycord + cellsize / 2, 20).attr({
		                fill: whites,
		                stroke: "#000",
		                opacity: 0
		            }).data("defined", false).data("colour", whites);
		            var toggleToken = function (op) {
	                    return function () {
	                        if (!circlefield.data("defined")) {
	                            circlefield.animate({
	                                opacity: op
	                            }, 200, "backOut");
	                        }
		                };
		            };
		            var hoverField = r.rect(xcord, ycord, cellsize, cellsize).data("row", row).data("column", column).attr({
		                fill: "#333333",
		                stroke: "#422faa",
		                opacity: 0
		            }).hover(toggleToken(1), toggleToken(0)).click(function () {
		                if(circlefield.data("defined") === true) {
		                	circlefield.data("colour", (circlefield.data("colour") === whites ? blacks : whites ));  
		            	}
		            	circlefield.data("defined", true);
		                circlefield.attr({
		                    opacity: 1,
		                    fill: circlefield.data("colour")
		                });
		            });
		        };
		    var Raph = new Raphael("othello", gridsize, gridsize, function () {
		        var r = this;
		        var header = r.text(356, 50, "White play").attr({
		            font: "bold 40px Helvetica",
		            fill: "#9872fa"
		        });
		        var leftPlayer = r.text(40, 130, "White\n Scores").attr({
		            font: "bold 14px Helvetica",
		            fill: "#fa1247"
		        });
		        var rightPlayer = r.text(672, 130, "Black\n Scores").attr({
		            font: "bold 14px Helvetica",
		            fill: "#fa1247"
		        });
		        for (var i = 0; i < size * size; ++i) {
		            var column = Math.floor(i / 8);
		            var row = i % size;
		            var xcord = baseOffset + row * (cellsize + 1);
		            var ycord = baseOffset + column * (cellsize + 1);
		            new Field(xcord, ycord, row, column, r);
		        }
		    });
		})();
		</script>
		<title>Raphael Othello</title>
	</head>
	<body>
		<div id="othello">
		</div>
	</body>
</html>
